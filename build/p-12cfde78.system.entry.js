var __spreadArrays=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<o;t++)for(var s=arguments[t],l=0,r=s.length;l<r;l++,i++)n[i]=s[l];return n};System.register(["./p-7f8680f3.system.js","./p-7865d7dd.system.js"],(function(e){"use strict";var t,o,n,i;return{setters:[function(e){t=e.r;o=e.h;n=e.c},function(e){i=e.K}],execute:function(){var s=".autocomplete.sc-d4l-autocomplete{position:relative;color:var(--c-primary)}.autocomplete.sc-d4l-autocomplete select.sc-d4l-autocomplete,.autocomplete__status-message.sc-d4l-autocomplete{height:1px;width:1px;overflow:hidden;position:absolute;clip:rect(1px, 1px, 1px, 1px)}.autocomplete.sc-d4l-autocomplete [role='listbox'].sc-d4l-autocomplete{margin:0;padding:0.5em 0;max-height:12em;width:100%;overflow-y:scroll;position:absolute;top:2.3em;list-style:none;z-index:2;-webkit-box-shadow:var(--shadow-soft);box-shadow:var(--shadow-soft);border-bottom-left-radius:4px;border-bottom-right-radius:4px;-webkit-overflow-scrolling:touch;background-color:#fff}.autocomplete.sc-d4l-autocomplete [role='listbox'].sc-d4l-autocomplete>li.sc-d4l-autocomplete{padding:0.5em 1em;outline:0}.autocomplete.sc-d4l-autocomplete [role='option'].sc-d4l-autocomplete:hover,.autocomplete.sc-d4l-autocomplete [role='option'][aria-selected='true'].sc-d4l-autocomplete{background-color:var(--c-gray-lightest)}.autocomplete__drowdown-button.sc-d4l-autocomplete{position:absolute;right:0;top:-2px;padding:10px;background:none;border:0}.is-hidden.sc-d4l-autocomplete{display:none}";var l=e("d4l_autocomplete",function(){function e(e){var s=this;t(this,e);this.inputId=null;this.classes="";this.label="";this.selectedOption=null;this.required=false;this.errorMessage="";this.statusNoResults="No results";this.statusResultsFound="results found";this.options=[];this.inputValue="";this.isMenuHidden=true;this.selectedValue="";this.activeOptionIndex=null;this.filteredOptions=[];this.hasError=false;this.autocompleteOptionIdPrefix="autocomplete-option";this.resetMenuState=function(){s.isMenuHidden=true;s.filteredOptions=[];s.activeOptionIndex=null};this.filterForMatches=function(e,t){if(t===void 0){t="dataAlt"}return s.options.filter((function(o){return o[t].toString().trim().toLowerCase().indexOf(e)>-1}))};this.onInputTextType=function(){var e=s.inputValue.trim().toLowerCase();if(e.length>0){s.filteredOptions=s.filterForMatches(e);s.isMenuHidden=false}else{s.selectedValue="";s.selectedValueChangedHandler(null);s.resetMenuState()}};this.onInputTextDownPressed=function(){var e=s.inputValue.trim().toLowerCase();if(e.length===0){s.filteredOptions=__spreadArrays(s.options)}else{s.filteredOptions=s.filterForMatches(e,"text")}s.activeOptionIndex=0;s.isMenuHidden=false;setTimeout((function(){return s.autocompleteMenuElement.querySelector("li").focus()}),0)};this.onInputTextKeyDown=function(e){if(i.isTab(e)){s.selectOptionOnFocusOut();s.resetMenuState()}};this.onInputTextChange=function(e){s.inputValue=e.target.value};this.onInputTextClick=function(){s.filteredOptions=__spreadArrays(s.options);s.isMenuHidden=false};this.onInputTextKeyUp=function(e){if(i.isEsc(e)||i.isUp(e)||i.isLeft(e)||i.isRight(e)||i.isSpace(e)||i.isEnter(e)||i.isTab(e)||i.isShift(e)){return}else if(i.isDown(e)){s.onInputTextDownPressed();return}s.onInputTextType();return};this.onDropdownButtonClick=function(){s.onInputTextClick();s.activeOptionIndex=0;setTimeout((function(){s.autocompleteMenuElement.querySelector("li").focus()}),0)};this.selectOption=function(e){s.hasError=false;s.d4lInputElement&&s.d4lInputElement.querySelector("input").setCustomValidity("");s.selectedValue=e.value;s.selectedValueChangedHandler(e.id);s.inputValue=e.text;s.isMenuHidden=true};this.selectOptionOnFocusOut=function(){var e=s,t=e.errorMessage,o=e.filteredOptions,n=e.required;var i=s.inputValue.trim().toLowerCase();if(i.length&&o.length===1&&o[0].text.trim().toLowerCase().includes(i)){s.selectOption(o[0])}if(n&&s.selectedValue===""){s.hasError=true;s.d4lInputElement.querySelector("input").setCustomValidity(t)}};this.onOptionUpArrow=function(e){e.preventDefault();if(s.activeOptionIndex===0){s.resetMenuState();s.autoCompleteInputTextElement.focus()}else{s.activeOptionIndex--;e.target.previousElementSibling.focus()}};this.onOptionDownArrow=function(e){e.preventDefault();if(s.filteredOptions.length-1>s.activeOptionIndex){s.activeOptionIndex++;e.target.nextElementSibling.focus()}};this.onOptionEscape=function(){s.resetMenuState();s.autoCompleteInputTextElement.focus()};this.onMenuKeyDown=function(e){if(i.isUp(e)){s.onOptionUpArrow(e);return}else if(i.isDown(e)){s.onOptionDownArrow(e);return}else if(i.isEnter(e)){s.selectOption(s.filteredOptions[s.activeOptionIndex]);return}else if(i.isSpace(e)){s.selectOption(s.filteredOptions[s.activeOptionIndex]);return}else if(i.isEsc(e)){s.onOptionEscape();return}else if(i.isTab(e)){s.selectOptionOnFocusOut();s.resetMenuState();return}s.autoCompleteInputTextElement.focus()};this.renderListItems=function(){var e=s,t=e.selectOption,n=e.activeOptionIndex,i=e.autocompleteOptionIdPrefix,l=e.filteredOptions;return l.map((function(e,s){return o("li",{id:i+"-"+s,tabindex:"-1","aria-selected":(n===s).toString(),role:"option",onClick:function(){return t(e)}},e.text)}))};this.selectedValueChanged=n(this,"selectedValueChanged",7)}e.prototype.onChangeSelectedOption=function(e,t){if(e!==t){this.selectOption(e)}};e.prototype.selectedValueChangedHandler=function(e){this.selectedValueChanged.emit({key:e,value:this.selectedValue})};Object.defineProperty(e.prototype,"status",{get:function(){return this.filteredOptions.length?this.filteredOptions.length+" "+this.statusResultsFound:this.statusNoResults},enumerable:true,configurable:true});e.prototype.componentWillLoad=function(){var e=this.selectedOption;e&&this.selectOption(e)};e.prototype.componentDidLoad=function(){this.autoCompleteInputTextElement=this.autocompleteElement.querySelector("input[role=combobox]")};e.prototype.handleDocumentClick=function(e){var t=this.autocompleteElement;if(t&&t!==e.target&&!t.contains(e.target)){this.selectOptionOnFocusOut();this.resetMenuState()}};e.prototype.render=function(){var e=this;var t=this,n=t.inputId,i=t.classes,s=t.label,l=t.required,r=t.inputValue,u=t.options,a=t.status,p=t.selectedValue,c=t.isMenuHidden,d=t.filteredOptions,f=t.onInputTextChange,h=t.onInputTextKeyUp,m=t.onInputTextKeyDown,x=t.onInputTextClick,O=t.onDropdownButtonClick,g=t.onMenuKeyDown,v=t.statusNoResults,y=t.renderListItems,b=t.hasError;return o("div",{class:"autocomplete "+i,ref:function(t){return e.autocompleteElement=t}},o("select",{"aria-hidden":"true",tabindex:"-1"},o("option",null,"Select"),!!u.length&&u.map((function(e){return o("option",{value:e.value,"data-alt":e.dataAlt,selected:p==e.value},e.text)}))),o("d4l-input",{"input-id":n,type:"text",error:b,label:s,value:r,role:"combobox",required:l,autocomplete:"off",autocapitalize:"none","aria-autocomplete":"list","aria-expanded":!c,"aria-owns":"autocomplete-options",handleInput:f,handleKeyUp:h,handleKeyDown:m,handleClick:x,ref:function(t){return e.d4lInputElement=t}}),o("button",{type:"button",class:"autocomplete__drowdown-button","aria-label":"Open dropdown menu",onClick:O},o("d4l-icon-arrow",{classes:"icon--extra-small"})),o("ul",{id:"autocomplete-options",role:"listbox",class:c&&"is-hidden",onKeyDown:g,ref:function(t){return e.autocompleteMenuElement=t}},!!d.length?y():o("li",null,v)),o("div",{class:"autocomplete__status-message","aria-live":"polite",role:"status"},!c&&a))};Object.defineProperty(e,"watchers",{get:function(){return{selectedOption:["onChangeSelectedOption"]}},enumerable:true,configurable:true});return e}());l.style=s}}}));