import{h as t,r as e,c as a}from"./p-f64a55b6.js";import"./p-58a1d276.js";import"./p-750b86e2.js";import{a as i}from"./p-a734bee0.js";import{L as s,R as r}from"./p-5aac379d.js";import"./p-7464db8b.js";import{Q as o}from"./p-4545c72d.js";import{v as n}from"./p-d692fd31.js";import{u as l,c as d,a as h,g as c,b as u}from"./p-d554a78c.js";const p=()=>t("div",null,t("d4l-date-input",{"data-test":"questionnaireDateInputs",label:i.t("input_date_label"),errorMessage:i.t("input_date_error"),fields:{day:{label:`${i.t("input_date_label_day")}`,placeholder:`${i.t("input_date_placeholder_day")}`},month:{label:`${i.t("input_date_label_month")}`,placeholder:`${i.t("input_date_placeholder_month")}`},year:{label:`${i.t("input_date_label_year")}`,placeholder:`${i.t("input_date_placeholder_year")}`}},futureAllowed:!1}),t("div",{class:"input-date__help"},i.t("input_date_help"))),_=class{constructor(t){e(this,t),this.currentStep=0,this.answerData={},this.scoreData={},this.setLocalStorageAnswers=()=>{localStorage.setItem(s.ANSWERS,JSON.stringify(this.answerData)),localStorage.setItem(s.SCORES,JSON.stringify(this.scoreData)),localStorage.setItem(s.COMPLETED,"false"),n.set()},this.moveToNextStep=()=>{const t=this.answerData[o[this.currentStep].id];if(this.scoreData=l(this.currentStep,t,this.scoreData),this.setLocalStorageAnswers(),!this.checkFinished()){this.currentStep=d(this.currentStep,t);const e=this.currentStep;if(this.currentStep=h(this.currentStep,this.scoreData,this.answerData),e!==this.currentStep)return void this.checkFinished();this.trackStepMove(!1)}},this.checkFinished=()=>this.currentStep>=o.length-1&&(this.history.push(r.SUMMARY,{}),!0),this.moveToPreviousStep=()=>{if(0===this.currentStep)this.history.push("/",{}),localStorage.removeItem(s.ANSWERS);else{const t=JSON.parse(localStorage.getItem(s.ANSWERS));if(this.answerData&&t){const e=Object.keys(t);let a=e[e.length-1];const i=o[u(a)];i.scoreMap&&(this.scoreData[i.category]-=c(i,t[a])),delete t[a],this.answerData=t,this.setLocalStorageAnswers(),this.currentStep=a?u(a):0}else this.currentStep--;this.trackStepMove(!0)}},this.submitForm=t=>{var e;t.preventDefault(),null===(e=t.target.querySelector("input"))||void 0===e||e.focus(),this.moveToNextStep()},this.componentWillLoad=()=>{this.showLogoHeader.emit({show:!1}),n.match()||n.reset();const t=JSON.parse(localStorage.getItem(s.ANSWERS)),e=JSON.parse(localStorage.getItem(s.SCORES));this.answerData=t||{},this.scoreData=e||{};const a=Object.keys(this.answerData);a.length&&(this.currentStep=u(a[a.length-1]),this.moveToNextStep())},this.showLogoHeader=a(this,"showLogoHeader",7)}changedLanguageHandler(t){this.language=t.detail.code}handlePopStateChange(){this.currentStep>0&&(this.history.push(r.QUESTIONNAIRE,{}),this.moveToPreviousStep())}updateFormDataHandler(t){const{detail:e}=t;this.setFormData(e.key,e.value)}dateChangeHandler(t){const{currentStep:e}=this,{detail:{value:a}}=t;this.setFormData(o[e].id,a.split("-").join("."))}setFormData(t,e){this.answerData=Object.assign(Object.assign({},this.answerData),{[t]:e})}get progress(){return Math.floor((this.currentStep+1)/o.length*100)}trackStepMove(t){}render(){const{submitForm:e,currentStep:a,moveToPreviousStep:s,progress:r}=this;return a<o.length&&t("div",{class:"questionnaire c-card-wrapper"},t("form",{onSubmit:t=>e(t),ref:t=>this.formElement=t,"data-test":"questionnaireForm"},t("d4l-card",{classes:"card--desktop card--text-center"},t("div",{class:"u-margin-horizontal--card-negative",slot:"card-header"},t("ia-navigation-header",{headline:i.t(o[a].text),handleClick:()=>s()}),t("d4l-linear-progress",{"data-test":"progressBar",value:r})),t("div",{class:"questionnaire__content u-padding-vertical--medium u-text-align--left",slot:"card-content"},t("fieldset",null,t("legend",{class:"u-visually-hidden"},i.t(o[a].text)),o[a].comment&&t("p",{class:"questionnaire__comment",innerHTML:`${i.t(o[a].comment)}`}),t("div",{class:"questionnaire__form u-padding-vertical--normal "},"radio"===o[a].inputType&&t("ia-input-radio",{"data-test":"questionnaireRadioInputs",question:o[a],currentSelection:this.answerData[o[a].id]}),"checkbox"===o[a].inputType&&t("ia-input-multiple-choice",{question:o[a]}),"date"===o[a].inputType&&t(p,null),"postal"===o[a].inputType&&t("ia-input-postal-code",{question:o[a]})))),t("div",{slot:"card-footer"},t("d4l-button",{classes:"button--block","data-test":"continueButton",text:i.t(a===o.length-1?"questionnaire_button_generate_qr":"questionnaire_button_next")})))))}};_.style=".questionnaire__content{min-height:15em}.questionnaire__content fieldset{border:0;margin:0;padding:0}.questionnaire input[type='radio']+label::before{border-color:var(--c-gray) !important}.questionnaire input[type='radio']:checked+label::after{background-color:var(--c-gray) !important}d4l-button .button.sc-d4l-button:disabled{background-color:var(--c-gray-lighter);border-color:var(--c-gray-lighter)}";export{_ as ia_questionnaire}